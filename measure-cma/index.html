<!DOCTYPE html>
<html>
  <head>
    <title>CMA Measurement Tool</title>
    <link rel="stylesheet" href="style.css" />
    <script src="measure.js"></script>
  </head>
  <body>
    <header>
      <h1>CMA Measurement Tool</h1>
      <div class="info">
        <a href="#" id="what-is-this-button">What is this?</a>
      </div>
    </header>
    <div id="what-is-this-modal" class="hidden">
      <div class="modal-content">
        <div>
          <button id="close-modal">&lsaquo; Back</button>
          <h2>What is this?</h2>
        </div>
        <p>
          A useful characteristic for identifying Usnea species is the relative
          size of the cortex, medulla, and axis when viewed in cross section.
          This is a tool for quickly making CMA measurements and downloading
          annotated images.
        </p>
        <h2>How to use</h2>
        <p>
          This website is best used on desktop, but also works on mobile. No
          data leaves your browser, and progress is <strong>not</strong> saved.
          Find a bug or have an idea for an improvement? Contact me at well1912
          (at) gmail, or
          <a href="https://github.com/welliam/welliam.github.io/issues/new"
            >leave an issue</a
          >
          on the
          <a href="https://github.com/welliam/welliam.github.io">GitHub repo</a
          >! PRs are also welcome.
        </p>
        <p>
          To use, first upload a photo of an Usnea cross section. To make
          measurements, click where the cortex starts on one side, then where it
          ends on the other, making sure to bisect as straight through the
          lichen as possible. Follow up with 4 more clicks on the boundary
          between cortex and medulla and medulla and axis on both sides of the
          lichen. The CMA will be displayed on the webpage.
        </p>
        <p>
          If a mistake is made while adding measurements, the undo (&#x21B6;)
          and redo (&#x21B7;) buttons can be used (ctrl-z also works!). To clear
          measurements and start over, click the "Clear measurements" button. To
          clear the image and upload another, click the "Reset" button.
        </p>

        <p>
          You can download your annotated image at this point by clicking the
          "Download" button. The Label field annotates what the photo is of, and
          the "Include CMA" option lets you toggle adding the CMA measurement on
          the image. To leave out the label entirely, clear the Label field.
        </p>
        <p>
          Below illustrates the suggested measurement order:
          <img src="./demo.png" />
        </p>
      </div>
    </div>
    <div>
      <img style="display: none" id="source" />
      <button id="measurement-undo">&#x21B6;</button>
      <button id="measurement-redo">&#x21B7;</button>
      <button id="clear-dots" disabled>Clear measurements</button>
      <button id="download-canvas" disabled>Download</button>
      <label for="image-input" id="image-input-label" class="hidden">
        <button>New</button>
      </label>
      <input
        id="image-input"
        type="file"
        accept="image/png, image/jpeg"
        class="hidden"
      />
      <div class="label-controls">
        <label>Label <input id="label-input" /></label>
        <label
          ><input id="input-include-cma" type="checkbox" />Include CMA</label
        >
      </div>
      <div id="displays">
        <span id="diameter-display"></span>
        <span id="cma-display"></span>
        <button id="toggle-show-breakdown-button">
          Show/hide calculation breakdown
        </button>
      </div>
      <div id="cma-calculation-breakdown"></div>
    </div>
    <div class="canvas-container">
      <canvas id="image-canvas"></canvas>
      <canvas id="drawing-canvas"></canvas>
      <div id="image-upload"></div>
    </div>
  </body>
</html>
